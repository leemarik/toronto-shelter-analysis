---
title: "Toronto Shelter System Flow Analysis"
subtitle: "Analysis of Shelter Use Patterns in Toronto"
author: 
  - Mariko Lee
thanks: "Code and data are available at: https://github.com/leemarik/toronto-shelter-analysis"
toc: true
toc-depth: 2
date: today
date-format: long
abstract: "This paper analyzes the Toronto Shelter System data from Open Data Toronto. The analysis focuses on shelter usage trends, population group percentage, and demographic insights. Key findings include the distribution of shelter use across different age group, and overall shelter occupancy rate. The findings assist in understaanding the patterns of homelessness and shelter use in Toronto over time"
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

# Load necessary libraries
library(tidyverse)
library(readr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(scales)
library(janitor)

# Load The Toronto Shelter Dataset
cleaned_data <- read_csv("../data/analysis_data/cleaned_shelter_data.csv")

```


# Introduction

Toronto is not an exception to the rule that large cities throughout the world continues to struggle with homelessness. designing policies and programs that may effectively serve the needs of this group requires an understanding of the demographic distribution of those who rely on shelter services as well as the patterns of shelter utilization. The goal of this study is to investigate the Toronto Shelter System data set from Toronto Open Data, which offers comprehensive statistics on the city's shelter usage over time. 

Through an analysis of shelter occupancy rates among various age, gender, and population categories, important insights on the dynamics of shelter use in Toronto can be obtained. Important trends will also be highlighted by this analysis, including which demographics are most vulnerable to homelessness and how shelter capacity varies.

## Literature Review and Research Gap

## Research Question & Hypothesis

# Methods



# Result

#Data

This analysis uses data from Toronto Open Data (@fig-shelter). The dataset includes shelter occupancy trends, broken down by age group, gender, and other demographic factors. The goal of this analysis is to provide insight into shelter usage patterns in Toronto, helping policymakers understand the population groups most affected by homelessness.

1. Shelter Occupancy Trends by Age Group and Gender
This graph will show the number of shelter occupants by age group, separated by gender.

```{r}
#| label: fig-shelter
#| fig-cap: Shelter Occupancy Trends by Age Group and Gender
#| echo: false

# Create the plot
ggplot(cleaned_data_long, aes(x = occupants_age, y = age_group, fill = gender)) +
  geom_bar(stat = "identity", position = "stack", alpha = 0.8) +
  scale_fill_manual(values = c("lightblue", "pink"), guide = "legend") +
  labs(
    title = "Shelter Occupancy Trends by Age Group and Gender",
    subtitle = "Comparison of male and female shelter occupants across different age groups",
    x = "Number of Occupants",
    y = "Age Group",
    fill = "Gender"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    axis.text.x = element_text(angle = 0, hjust = 1)
  ) +
  scale_x_continuous(labels = scales::comma) +
  coord_flip()


```


2. Transition Trend Over Time
This graph will show the number of people transitioning from or to shelter, like returned_from_housing, newly_identified, and moved_to_housing.

```{r}
#| label: fig-trend
#| fig-cap: Transition Trend Over Time
#| echo: false

# Assuming you have columns: returned_from_housing, newly_identified, moved_to_housing, and a time column (e.g., date)

# Reshape the data to long format for plotting
transition_data <- cleaned_data %>%
  pivot_longer(cols = c("returned_from_housing", "newly_identified", "moved_to_housing"), 
               names_to = "transition_type", values_to = "count")

# Plot - Transition Trends Over Time
ggplot(transition_data, aes(x = date, y = count, color = transition_type)) +
  geom_line(size = 1.2) +
  labs(
    title = "Shelter Transition Trends Over Time",
    subtitle = "Trends in shelter transitions including returns from housing and newly identified individuals",
    x = "Date",
    y = "Number of Transitions",
    color = "Transition Type"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12)
  )


```

3. Population Groups
This graph will show different population groups like chronic, refugees, families, and youth in shelters over time.
```{r}
# Reshape population group data to long format
population_group_data <- cleaned_data %>%
  pivot_longer(cols = c("chronic", "refugees", "families", "youth"), 
               names_to = "population_group", values_to = "count")

# Plot - Population Group Trends Over Time
ggplot(population_group_data, aes(x = date, y = count, color = population_group)) +
  geom_line(size = 1.2) +
  labs(
    title = "Population Group Trends Over Time in Shelters",
    subtitle = "Trends of various population groups including chronic, refugees, families, and youth",
    x = "Date",
    y = "Number of People",
    color = "Population Group"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12)
  )

```

4. Age Distribution of Shelter Users
This graph will show the distribution of shelter users across age groups, giving a clearer view of which age group uses the shelter system the most.
```{r}
# Plot - Age Distribution of Shelter Users
ggplot(cleaned_data_long, aes(x = age_group, y = occupants, fill = age_group)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Age Distribution of Shelter Users",
    subtitle = "Number of shelter occupants across different age groups",
    x = "Age Group",
    y = "Number of Occupants",
    fill = "Age Group"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12)
  ) +
  coord_flip()

```

5. Gender-Based Shelter Trends Over Time
This graph will show how shelter occupancy for males and females changes over time.

```{r}
# Assuming there is a time/date column and gender columns (gender_male, gender_female)

# Reshape gender-based data to long format
gender_trends_data <- cleaned_data %>%
  pivot_longer(cols = c("gender_male", "gender_female"), 
               names_to = "gender", values_to = "occupants") %>%
  mutate(gender = ifelse(gender == "gender_male", "Male", "Female"))

# Plot - Gender-Based Shelter Trends Over Time
ggplot(gender_trends_data, aes(x = date, y = occupants, color = gender)) +
  geom_line(size = 1.2) +
  labs(
    title = "Gender-Based Shelter Occupancy Trends Over Time",
    subtitle = "Trends in shelter occupancy by gender across different periods",
    x = "Date",
    y = "Number of Occupants",
    color = "Gender"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12)
  )


```


# Discussion

# Conclusion 

\newpage

\appendix

# Appendix {-}




\newpage


# References


